(function(t){function e(e){for(var i,a,s=e[0],c=e[1],u=e[2],p=0,f=[];p<s.length;p++)a=s[p],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},o={app:0},r=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/id-photo/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},1552:function(t,e,n){t.exports=n.p+"img/test.522ebf4e.png"},"22ce":function(t,e,n){"use strict";n("8353")},2491:function(t,e,n){"use strict";n("e6c7")},"24ab":function(t,e,n){"use strict";n("f875")},"3ee2":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=(n("d3b7"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("bc3a")),r=n.n(o),a={baseURL:"http://150.158.13.8:3030",timeout:6e4},s=r.a.create(a);s.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),s.interceptors.response.use((function(t){return console.log(t,111),t}),(function(t){console.log(t.response);var e=new TextDecoder("utf-8"),n=e.decode(new Uint8Array(t.response.data));return console.log(n),Promise.reject(t)})),Plugin.install=function(t){t.axios=s,window.axios=s,Object.defineProperties(t.prototype,{axios:{get:function(){return s}},$axios:{get:function(){return s}}})},i["a"].use(Plugin);Plugin,n("499a");var c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},u=[],l=(n("034f"),n("2877")),p={},f=Object(l["a"])(p,c,u,!1,null,null,null),d=f.exports,h=n("8c4f"),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-box"},[n("div",{staticClass:"header-filter"},[n("van-field",{attrs:{placeholder:"输入关键字检索"},on:{input:function(e){t.$delay((function(){t.search()}),500)}},model:{value:t.keyWords,callback:function(e){t.keyWords=e},expression:"keyWords"}})],1),n("div",{staticClass:"photo-list"},t._l(t.list,(function(e,i){return n("div",{key:i,staticClass:"photo-item row-between-center",on:{click:function(n){return t.genPhoto(e)}}},[n("div",{staticClass:"left"},[n("p",{staticClass:"title"},[t._v(t._s(e.name))])]),n("div",{staticClass:"right"},[n("p",{staticClass:"desc"},[t._v(t._s(e.width)+" * "+t._s(e.height))])])])})),0),t._e()])},m=[],v=(n("e9c4"),n("4de4"),n("b0c0"),[{name:"社保照",width:358,height:441,maxSize:20,minSize:10,mark:"",desc:"",background:"#fff"},{name:"一寸",width:295,height:413,mark:"",desc:"",background:"#fff"},{name:"二寸",width:413,height:579,mark:"",desc:"",background:"#fff"},{name:"会计资格证",width:114,height:156,mark:"",desc:"",background:"#fff"},{name:"护士资格证",width:160,height:210,mark:"",desc:"",background:"#fff"}]),b=v,w={data:function(){return{inputApiKeyVisible:!0,cameraVisible:!1,removeBgKey:"",keyWords:"",list:b}},created:function(){if(!localStorage.getItem("SETTING")){var t={apiKey:""};localStorage.setItem("SETTING",JSON.stringify(t))}},methods:{search:function(){var t=this;this.keyWords?this.list=this.list.filter((function(e){return-1!==e.name.indexOf(t.keyWords)})):this.list=b},genPhoto:function(t){localStorage.setItem("PHOTO_OPTION",JSON.stringify(t)),this.$router.push("/photo")},openSetting:function(){this.$router.push("/setting")},open:function(){this.$router.push("/compressor")}}},y=w,O=(n("22ce"),Object(l["a"])(y,g,m,!1,null,"60af2efb",null)),x=O.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[t.picFile?n("cut-pic",{ref:"cutPic",staticClass:"aoe-cut-pic-box",attrs:{outputWidth:t.photoOptions.width,fixedNumber:[t.photoOptions.width,t.photoOptions.height],picObj:t.picFile},on:{getCutPic:t.getCutPic}}):t._e(),n("div",{staticClass:"setting"},[n("div",{staticClass:"doc-block__title"},[t._v("背景")]),n("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.outputOption.background,callback:function(e){t.$set(t.outputOption,"background",e)},expression:"outputOption.background"}},[n("van-radio",{attrs:{name:1}},[t._v("红底")]),n("van-radio",{attrs:{name:2}},[t._v("蓝底")]),n("van-radio",{attrs:{name:3}},[t._v("白底")])],1)],1),n("div",{staticClass:"bottom-wrap"},[n("van-button",{staticClass:"margin-left-10",attrs:{color:"#7232dd",plain:""},on:{click:t.openSelectFile}},[t._v("上传图片")]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"file",name:"file",id:"fileSelect",accept:"image/*"},on:{change:t.fileChange}}),n("van-button",{staticClass:"margin-left-10",staticStyle:{flex:"1"},attrs:{color:"linear-gradient(to right, #ff6034, #ee0a24)"},on:{click:function(e){return t.clipPic("confirm")}}},[t._v(" 确认 ")])],1),n("Pupop",{staticClass:"padding-30-0",attrs:{position:"right",background:"#2c3e50",show:t.previewVisible}},[n("div",{staticClass:"preview-box",style:{width:t.photoOptions.width+"px",height:t.photoOptions.height+"px",background:t.backgroundMapper[t.outputOption.background]}},[n("img",{staticClass:"preview-img",attrs:{src:t.output,alt:"",srcset:""}})])]),n("Pupop",{staticClass:"padding-30-0",attrs:{position:"right",background:"#2c3e50",show:t.resultVisible}},[n("div",{staticClass:"preview-box",style:{width:t.photoOptions.width+"px",height:t.photoOptions.height+"px"}},[n("img",{staticClass:"preview-img",attrs:{src:t.resultUrl,alt:"",srcset:""}})])]),n("van-overlay",{staticClass:"row-center",staticStyle:{"text-align":"center"},attrs:{show:t.loading}},[n("van-loading",{staticStyle:{"text-align":"center",width:"100vw"},attrs:{size:"24px"}},[t._v(t._s(t.loadMsg)+"...")])],1)],1)},S=[],C=n("1da1"),_=(n("96cf"),1048576),P={name:"Home",data:function(){return{outputOption:{background:1,size:10},backgroundMapper:["","#FF0000","#438EDB","#FFFFFF"],picture:"",picFile:null,output:null,previewVisible:!1,cameraVisible:!1,resultVisible:!1,photoOptions:{},loadMsg:"图片生成中",setting:{},loading:!1,resultUrl:null,action:"preview"}},beforeRouteEnter:function(t,e,n){localStorage.getItem("PHOTO_OPTION")?n():n("/photo")},created:function(){this.picFile=localStorage.getItem("LAST_URL")||n("1552"),this.photoOptions=JSON.parse(localStorage.getItem("PHOTO_OPTION")),document.title=this.photoOptions.name,this.setting=JSON.parse(localStorage.getItem("SETTING"))},mounted:function(){window.history&&window.history.pushState&&window.addEventListener("popstate",this.closePopup,!1)},beforeDestroy:function(){window.removeEventListener("popstate",this.closePopup,!1)},methods:{openSelectFile:function(){var t=document.getElementById("fileSelect");t.click()},drawPicToCanvas:function(t){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function n(){var i,o,r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=e,o=document.createElement("canvas"),r=o.getContext("2d"),o.width=e.photoOptions.width,o.height=e.photoOptions.height,r.fillStyle=e.backgroundMapper[e.outputOption.background],r.fillRect(0,0,o.width,o.height),a=new Image,a.crossOrigin="anonymous",a.src=t,a.onload=Object(C["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.drawImage(a,0,0,o.width,o.height),i.resultUrl=o.toDataURL({pixelRatio:1}),i.loading=!1,i.openResultModel();case 4:case"end":return t.stop()}}),t)})));case 11:case"end":return n.stop()}}),n)})))()},openCameraModel:function(){document.title="拍照",history.pushState(null,null,document.URL),this.cameraVisible=!0},openPreviewModel:function(){document.title="预览图",history.pushState(null,null,document.URL),this.clipPic("preview"),this.previewVisible=!0},openResultModel:function(){document.title="结果图",history.pushState(null,null,document.URL),this.resultVisible=!0},closePopup:function(){document.title="生成证件照",this.previewVisible?this.previewVisible=!1:this.resultVisible?this.resultVisible=!1:this.cameraVisible?this.cameraVisible=!1:this.$router.go(-1)},clipPic:function(t){this.action=t,this.$refs.cutPic.clip()},getCutPic:function(t){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$file2Base64(t);case 2:e.output=n.sent,"confirm"===e.action&&(e.loading=!0,e.drawPicToCanvas(e.output));case 4:case"end":return n.stop()}}),n)})))()},fileChange:function(){var t=this;return Object(C["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.loadMsg="正在处理图片",t.loading=!0,n=document.getElementById("fileSelect"),!n.files[0]){e.next=13;break}if(!(n.files[0]>=_)){e.next=11;break}return e.next=7,t.$picCompressor(n.files[0],1);case 7:i=e.sent,t.removeBg(i),e.next=12;break;case 11:t.removeBg(n.files[0]);case 12:n.value="";case 13:case"end":return e.stop()}}),e)})))()},removeBg:function(t){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function n(){var i,o,r,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e,o=new FormData,o.append("file",t,"test.jpg"),n.next=5,e.axios({method:"post",url:"/removebg",data:o,responseType:"arraybuffer",encoding:null}).catch((function(t){console.log(t),e.loading=!1}));case 5:r=n.sent,a=new Uint8Array(r.data),s=new FileReader,s.readAsDataURL(new Blob([a])),s.onloadend=function(){i.picFile=s.result,localStorage.setItem("LAST_URL",i.picFile),i.loading=!1};case 10:case"end":return n.stop()}}),n)})))()}}},T=P,$=(n("24ab"),Object(l["a"])(T,k,S,!1,null,"22e835f3",null)),j=$.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"doc-block__title"},[t._v("抠图API key")]),n("van-field",{attrs:{label:"API_KEY"},model:{value:t.options.apiKey,callback:function(e){t.$set(t.options,"apiKey",e)},expression:"options.apiKey"}}),n("div",{staticClass:"bottom-wrap"},[n("van-button",{staticStyle:{flex:"1"},attrs:{color:"linear-gradient(to right, #ff6034, #ee0a24)"},on:{click:t.save}},[t._v(" 保存 ")])],1)],1)},R=[],F={data:function(){return{options:{apiKey:""}}},created:function(){localStorage.getItem("SETTING")&&(this.options=JSON.parse(localStorage.getItem("SETTING")))},methods:{save:function(){var t=this;this.options.apiKey?(localStorage.setItem("SETTING",JSON.stringify(this.options)),this.$router.push("/")):this.$dialog.confirm({title:"提示",message:"缺少API_KEY将不会调用api进行抠图处理"}).then((function(){localStorage.setItem("SETTING",JSON.stringify(t.options)),t.$router.push("/")})).catch((function(){}))}}},N=F,E=Object(l["a"])(N,I,R,!1,null,null,null),M=E.exports;i["a"].use(h["a"]);var U=[{path:"/",name:"Home",meta:{title:"生成证件照"},component:x},{path:"/photo",name:"photo",meta:{title:"生成证件照"},component:j},{path:"/setting",name:"setting",meta:{title:"设置"},component:M}],V=new h["a"]({mode:"history",base:"/id-photo/",routes:U});V.beforeEach((function(t,e,n){var i;document.title=(null===(i=t.meta)||void 0===i?void 0:i.title)||"生成证件照",n()}));var B=V,L=n("7e79"),A=n.n(L),W=n("b970"),D=function(t,e){var n=e._c;return n("transition",{attrs:{name:"van-slide-"+e.props.position}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.props.show,expression:"props.show"}],staticClass:"pupop",style:{background:e.props.background?e.props.background:"#fff"}},[e._t("default")],2)])},K=[],J=(n("6f0f"),{}),z=Object(l["a"])(J,D,K,!0,null,"f01cc63e",null),G=z.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"aoe-cut-pic-box"},[n("div",{staticClass:"cut-box"},[n("vueCropper",{ref:"cropper",attrs:{img:t.picObj,high:!1,fixed:!0,enlarge:t.option.enlarge,autoCrop:!0,fixedBox:!0,infoTrue:!0,canMoveBox:!1,outputSize:t.option.size,outputType:t.option.outputType,fixedNumber:t.fixedNumber}})],1)])},q=[],Y=(n("a9e3"),n("b680"),{props:{picObj:{type:[String,Object],required:!0},outputWidth:{type:Number,default:750},outputType:{type:String,default:"file"},fixedNumber:{type:Array,default:function(){return[9,16]}}},data:function(){return{loading:!0,loadMsg:"初始化中",interval:null,option:{url:n("724e"),size:.9,outputType:"png",enlarge:1}}},mounted:function(){var t=this;this.interval=setInterval((function(){t.$refs.cropper.cropW&&(t.option.enlarge=(t.outputWidth/t.$refs.cropper.cropW).toFixed(10),t.loading=!1,clearInterval(t.interval),t.interval=null)}),100)},beforeDestroy:function(){this.interval&&clearInterval(this.interval)},methods:{blobToFile:function(t,e,n){var i=new window.File([t],e,{type:n});return i},clip:function(){var t=this;return Object(C["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.loadMsg="裁切中",t.loading=!0,"base64"===t.outputType&&t.$refs.cropper.getCropData((function(e){t.loading=!1,t.$emit("getCutPic",e)})),"file"===t.outputType&&t.$refs.cropper.getCropBlob((function(e){t.loading=!1;var n=t.blobToFile(e,"pic-".concat((new Date).getTime(),".jpg"),e.type);t.$emit("getCutPic",n)}));case 4:case"end":return e.stop()}}),e)})))()}}}),Q=Y,X=(n("2491"),Object(l["a"])(Q,H,q,!1,null,"154294f8",null)),Z=X.exports,tt={Pupop:G,CutPic:Z},et={install:function(t){for(var e in tt)t.component(e,tt[e])}},nt=(n("ac1f"),n("1276"),n("466d"),n("7c8d")),it=n.n(nt);function ot(t){return new Promise((function(e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsDataURL(t)}))}function rt(t,e){var n=t.split(","),i=n[0].match(/:(.*?);/)[1],o=window.atob(n[1]),r=o.length,a=new Uint8Array(r);while(r--)a[r]=o.charCodeAt(r);return new File([a],e,{type:i})}function at(t){for(var e="",n=new Uint8Array(t),i=n.byteLength,o=0;o<i;o++)e+=String.fromCharCode(n[o]);return window.btoa(e)}function st(t,e,n){return new window.File([t],e,{type:n})}function ct(t){return ut.apply(this,arguments)}function ut(){return ut=Object(C["a"])(regeneratorRuntime.mark((function t(e){var n,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:.7,t.abrupt("return",new Promise((function(t){new it.a(e,{quality:n,success:function(e){console.log(e),t(e)},error:function(t){console.log(t.message)}})})));case 2:case"end":return t.stop()}}),t)}))),ut.apply(this,arguments)}var lt={install:function(t){t.prototype.$file2Base64=ot,t.prototype.$dataURLtoFile=rt,t.prototype.$arrayBufferToBase64=at,t.prototype.$blobToFile=st,t.prototype.$picCompressor=ct}},pt=(n("157a"),n("3ee2"),n("2241")),ft=n("f564");i["a"].use(pt["a"]),i["a"].use(ft["a"]),i["a"].use(W["a"]),i["a"].use(A.a),i["a"].use(et),i["a"].use(lt),i["a"].config.productionTip=!1,i["a"].prototype.$dialog=pt["a"],i["a"].prototype.$notify=ft["a"],i["a"].prototype.$delay=function(){var t=0;return function(e,n){clearTimeout(t),t=setTimeout(e,n)}}(),new i["a"]({router:B,render:function(t){return t(d)}}).$mount("#app")},"6f0f":function(t,e,n){"use strict";n("efdd")},"724e":function(t,e,n){t.exports=n.p+"img/test.20149283.jpg"},8353:function(t,e,n){},"85ec":function(t,e,n){},e6c7:function(t,e,n){},efdd:function(t,e,n){},f875:function(t,e,n){}});